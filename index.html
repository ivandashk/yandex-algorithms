<html>
<body>
    <div>
        <h2>Задание 1. Спираль</h2>
        <input type="text" onkeyup="task1(this.value)">
        <h2>Задание 2. Все комбинации</h2>
        <input type="text" onkeyup="task2(this.value)">
        <h2>Задание 3. Сортировка вставками</h2>
        <input type="text" onkeyup="task3(this.value)">
    </div>
</body>    
<script>
    const task1 = (n) => {
        if(n === '') return;

        const matrixSize = parseInt(n);
        const matrix = new Array(matrixSize);
        for (let i = 0; i < matrixSize; i++) {
            matrix[i] = new Array(matrixSize).fill(-1);
        }

        const maxElementValue = matrixSize * matrixSize;
        const rules = [[1,0], [0,1], [-1,0], [0, -1]];
        let currentRule = 0;
        let x = -1;
        let y = 0;

        const changeRule = () => {
            if (currentRule < rules.length - 1) {
                currentRule++;
            } else {
                currentRule = 0;
            }
        }

        for (let num = 0; num < maxElementValue; num++) {
            let nextElementX = x + rules[currentRule][0];
            let nextElementY = y + rules[currentRule][1];
            if(nextElementX === matrixSize || nextElementY === matrixSize) {
                changeRule();
                nextElementX = x + rules[currentRule][0];
                nextElementY = y + rules[currentRule][1];
            }
            const nextElement = matrix[nextElementY][nextElementX];

            if (nextElement !== -1) {
                changeRule();
                nextElementX = x + rules[currentRule][0];
                nextElementY = y + rules[currentRule][1];
            }

            x = nextElementX;
            y = nextElementY;
            matrix[nextElementY][nextElementX] = num + 1;
        }

        console.log(matrix);
    }

    const task2 = (n) => {
        if(n === '') return;    
        const arrayLength = parseInt(n);
        let initialArray = [];
        for (let i = 0; i < arrayLength; i++) {
            initialArray.push(i + 1);
        }

        const factorial = (arrayLength) => {
            if (arrayLength === 0 || arrayLength === 1) return 1;
            return arrayLength * factorial(arrayLength-1);
        }

        const rearrangement = (orderNum, array) => {
            const length = array.length;
            const result = [];
            
            let i = orderNum;
            for(var pushIndex = 1; pushIndex <= length; pushIndex++) {
                const subFactorial = factorial(length - pushIndex);
                const nextDigitIndex = Math.floor((i + subFactorial - 1) / subFactorial);
                i -= (nextDigitIndex - 1) * subFactorial;

                result.push(array.splice(nextDigitIndex - 1, 1)[0]);
            }

            return result;
        }

        const result = [];
        const activeElements = 0;
        for (let orderNum = 1; orderNum <= factorial(arrayLength); orderNum++) {
            result.push(rearrangement(orderNum, initialArray.slice(0)).join(''));
        }

        console.log(result);
    }

    const task3 = (str) => {
        if (str === '') return; 

        const initialArray = str.split(',');
        if (initialArray.includes("")) return;
        for (let i = 0; i < initialArray.length; i++) {
            initialArray[i] = parseInt(initialArray[i])
        }

        const sortedArray = [];
        const insertValue = (value) => {
            if (sortedArray.length === 0) {
                sortedArray.push(value);
            } else {
                const sortedLength = sortedArray.length;
                for (let i = 0; i < sortedLength; i++) {
                    if (sortedArray[i] > value) {
                        sortedArray.splice(i, 0, value);
                        return;
                    }
                }
                sortedArray.push(value);
            }
        }

        for (let i = 0; i < initialArray.length; i++) {
            insertValue(initialArray[i]);
        }

        console.log(sortedArray);
    }
</script>
</html>